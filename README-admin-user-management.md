# 管理员用户管理功能

## 功能概述

新增了管理员用户管理功能，允许管理员查看所有用户并将普通用户提升为管理员。

## 主要功能

### 1. 用户列表展示
- 显示所有注册用户的详细信息
- 包含用户头像、姓名、邮箱、电话等基本信息
- 显示用户角色（Admin/User）
- 显示用户状态（已验证/未验证/被禁用）
- 显示注册时间和最后活跃时间

### 2. 用户搜索
- 支持按邮箱、姓名、电话号码搜索用户
- 实时搜索，500ms防抖优化

### 3. 用户统计
- 总用户数
- 活跃用户数（已验证邮箱）
- 未验证用户数
- 管理员用户数

### 4. 添加为管理员功能
- 一键将普通用户提升为管理员
- 实时更新用户角色显示
- 操作成功后显示通知

## 技术实现

### API 端点

#### 1. 获取用户列表
```
GET /api/admin/users
```
参数：
- `page`: 页码
- `pageSize`: 每页数量
- `keyword`: 搜索关键词

#### 2. 提升用户为管理员
```
POST /api/admin/users/{userId}/make-admin
```

#### 3. 获取用户Profile信息
```
GET /api/admin/users/{userId}/profile
```

### 数据库更新

功能会同时更新两个地方的用户角色信息：
1. `profiles` 表中的 `role` 字段
2. `auth.users` 表中的 `user_metadata.role` 字段

这确保了角色信息的一致性和即时生效。

### 权限控制

- 所有管理员相关的API都受到中间件保护
- 只有具有 `admin` 角色的用户才能访问这些功能
- 使用 Supabase RLS 策略进行数据库级别的权限控制

## 使用方法

1. 以管理员身份登录系统
2. 访问 `/admin/users` 页面
3. 查看用户列表，使用搜索功能查找特定用户
4. 对于需要提升为管理员的用户，点击"Make Admin"按钮
5. 系统会显示操作成功的通知，用户角色会立即更新

## 安全考虑

- 所有操作都需要管理员权限验证
- 使用 Supabase Admin Client 进行安全的用户数据操作
- 防止普通用户通过API直接修改角色信息
- 操作日志记录（可在后续版本中添加）

## 界面特性

- 响应式设计，支持移动端和桌面端
- 现代化的UI设计，使用 Tailwind CSS
- 加载状态和错误处理
- 实时通知反馈
- 分页支持，优化大量用户数据的展示 