# 待支付订单功能测试指南

## 修复内容

### Next.js 15 兼容性修复
- 修复了 `searchParams` 直接访问的错误
- 使用 `React.use()` 正确解包 `searchParams`
- 支持 Promise 和普通对象两种类型的 `searchParams`

## 测试步骤

### 1. 基础功能测试

#### 访问待支付订单页面
```
URL: /profile/orders?type=pending-payment
```

**预期结果：**
- 页面标题显示 "Pending Payments"
- 页面描述显示 "Orders that are ready for payment"
- 只显示可以支付的订单

#### 访问普通订单页面
```
URL: /profile/orders
```

**预期结果：**
- 页面标题显示 "My Orders"
- 页面描述显示 "Track and manage your PCB orders"
- 显示所有订单

### 2. 菜单导航测试

#### 侧边栏菜单
1. 登录用户账户
2. 进入 Profile 页面
3. 点击侧边栏 "Pending Payments" 菜单

**预期结果：**
- 正确跳转到 `/profile/orders?type=pending-payment`
- 页面显示待支付订单

### 3. 订单过滤测试

#### 准备测试数据
需要以下类型的订单：
1. **可支付订单**：有管理员订单记录，已设置价格，未支付
2. **不可支付订单**：无管理员订单记录或未设置价格
3. **已支付订单**：支付状态为 'paid'

#### 测试过滤逻辑
1. 访问 `/profile/orders?type=pending-payment`
2. 检查显示的订单列表

**预期结果：**
- 只显示可支付的订单（类型1）
- 不显示不可支付的订单（类型2、3）

### 4. 视觉元素测试

#### 状态标签
**可支付订单应显示：**
- 原有状态标签（如 "Quoted", "Reviewed" 等）
- 额外的绿色 "Ready to Pay" 标签

#### 操作按钮
**可支付订单应显示：**
- 查看按钮（眼睛图标）
- 绿色 "Pay" 按钮（信用卡图标）

#### 统计信息
**待支付页面应显示：**
- 订单数量标签：显示 "Pending Payments"
- 总金额标签：显示 "Total Amount Due"
- 正确计算的总金额

### 5. 交互功能测试

#### 支付按钮点击
1. 在待支付订单页面点击 "Pay" 按钮
2. 检查页面跳转

**预期结果：**
- 正确跳转到 `/payment/{orderId}` 页面

#### 查看按钮点击
1. 点击查看按钮（眼睛图标）
2. 检查页面跳转

**预期结果：**
- 正确跳转到 `/profile/orders/{orderId}` 页面

### 6. 错误处理测试

#### 无订单情况
1. 使用没有订单的用户账户
2. 访问待支付订单页面

**预期结果：**
- 显示空状态
- 不出现错误

#### 网络错误处理
1. 模拟网络错误
2. 检查错误处理

**预期结果：**
- 优雅处理错误
- 显示适当的错误信息

## 浏览器兼容性测试

### 支持的浏览器
- Chrome (最新版本)
- Firefox (最新版本)
- Safari (最新版本)
- Edge (最新版本)

### 响应式测试
- 桌面端 (1920x1080)
- 平板端 (768x1024)
- 移动端 (375x667)

## 性能测试

### 加载时间
- 页面首次加载时间 < 2秒
- 订单数据获取时间 < 1秒

### 内存使用
- 检查是否有内存泄漏
- 确保组件正确卸载

## 常见问题排查

### 1. searchParams 错误
**错误信息：** "searchParams should be unwrapped with React.use()"
**解决方案：** 已修复，使用 `React.use()` 解包

### 2. 订单不显示
**可能原因：**
- 订单没有管理员记录
- 管理员未设置价格
- 订单已支付

### 3. 支付按钮不显示
**检查项：**
- 确认是在待支付页面 (`type=pending-payment`)
- 确认订单满足支付条件
- 检查 `canOrderBePaid()` 函数返回值

## 测试清单

- [ ] 页面正常加载，无控制台错误
- [ ] 菜单导航正常工作
- [ ] 订单过滤逻辑正确
- [ ] 状态标签正确显示
- [ ] 支付按钮正常工作
- [ ] 统计信息正确计算
- [ ] 响应式设计正常
- [ ] 错误处理正常
- [ ] 性能表现良好 