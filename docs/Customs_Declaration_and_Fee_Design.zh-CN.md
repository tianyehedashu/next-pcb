# PCB海外电商-报关与费用设计

## 1. 行业实践概述

- **国际物流发货**需填写报关信息，B2B/B2C PCB订单均适用。
- 主流PCB厂商（如JLCPCB、PCBWay、ALLPCB）会收集收件公司名、税号、个人证件号、报关方式、用途、申报价值、备注等信息。
- 关税费用可能包括关税、增值税/消费税、代理（报关行）费及其他附加费。是否包含在快递费用中，取决于所选贸易术语（如DDP、DAP）。
- DDP（Delivered Duty Paid，完税后交货）通常所有关税费用已包含在快递费中。DAP/DDU下，税费由收件人到付。

## 报关方式说明

在PCB海外电商业务中，常见的报关方式及其费用关系如下：

### 1. 自报关（self declare）
- **定义**：收件人或发件人自行向海关申报货物信息，独立办理清关手续。
- **流程**：
  1. 用户收到快递公司或海关的通知后，需自行准备发票、装箱单、身份证明等资料。
  2. 向海关申报货物的品名、数量、价值等信息。
  3. 自行缴纳关税、增值税等相关税费。
  4. 完成清关后，货物才能被放行并送达。
- **费用关系**：
  - 关税、增值税等税费由收件人到付，快递费用中不包含这些税费。
  - 无需支付代理报关服务费（agent fee）。
- **适用场景**：
  - 收件人具备清关能力或有专门的清关团队。
  - 部分国家或地区政策要求必须由收件人自行申报。
- **适用国家/地区**：
  1. **政策要求收件人必须自行清关的国家**：如印度、印尼、越南、泰国、土耳其、俄罗斯等，通常要求收件人提供本地税号、个人证件等信息，并亲自完成清关。
  2. **买家具备清关能力或有专门清关团队的国家**：如欧美大部分国家（美国、德国、法国、意大利、加拿大等），企业买家常常选择DAP，方便灵活。
  3. **进口税费较高，买家希望自行控制申报和缴税的国家**：如巴西、阿根廷、墨西哥等拉美国家，买家常常倾向于DAP方式。
  4. **卖家无法提供DDP服务的国家**：如部分非洲、中东、东南亚国家，卖家通常只支持DAP。
- **简要总结**：self declare 就是"自报关"，即所有清关手续和税费由收件人自己负责，快递公司只负责运输，不参与报关和缴税。

### 2. 代理报关（agent declare）
- **定义**：委托快递公司或专业报关行作为代理，代为办理报关和清关手续。
- **流程**：用户提供所需资料，代理机构负责申报、缴税、清关。
- **费用关系**：
  - 关税、增值税等可由代理代缴，通常由收件人到付。
  - 需支付代理服务费（agent fee），部分情况下可包含在快递费中。
- **适用场景**：收件人不具备清关能力，或希望简化流程。

### 3. 完税后交货（DDP, Delivered Duty Paid）
- **定义**：DDP（Delivered Duty Paid，完税后交货）是一种国际贸易术语，意思是"卖家完税后交货"。在这种模式下，卖家负责将货物运输到买家指定地点，并承担所有风险和费用，包括运输、清关、缴纳关税和增值税等，直到货物交付给买家为止。
- **责任划分**：
  - 卖家负责：所有运输费用、出口和进口清关、关税、增值税、代理费等所有费用和手续。
  - 买家负责：仅需在指定地点收货，无需承担任何清关和税费手续。
- **流程**：
  1. 卖家安排运输，将货物运送到买家指定地点（如买家仓库、工厂等）。
  2. 卖家或其代理（如快递公司）负责办理出口和进口清关手续。
  3. 卖家预先支付所有关税、增值税和代理费，费用通常已包含在运费或总价中。
  4. 买家收到货物，无需再支付任何额外费用。
- **费用关系**：
  - 所有关税、增值税、代理费等全部包含在卖家报价或快递费用中，买家无需再支付。
  - 适合希望简化收货流程、提升客户体验的跨境电商场景。
- **简要总结**：DDP 就是"完税后交货"，即卖家负责到底，买家只需收货，无需操心清关和税费。

### 4. 到付/未完税交货（DAP/DDU, Delivered At Place/Unpaid）
- **定义**：卖家负责运输到目的地，收件人负责清关和缴税。
- **流程**：快递公司将货物送达目的国，收件人自行或委托代理清关、缴税。
- **费用关系**：
  - 关税、增值税等由收件人到付，快递费用不包含税费。
  - 代理费视是否委托代理清关而定。
- **适用场景**：  
  - 买家有能力或有专门团队负责清关。
  - 目的国政策要求收件人必须自行清关。
- **适用国家/地区**：
  1. **政策要求收件人必须自行清关的国家**：如印度、印尼、越南、泰国、土耳其、俄罗斯等，通常要求收件人提供本地税号、个人证件等信息，并亲自完成清关。
  2. **买家具备清关能力或有专门清关团队的国家**：如欧美大部分国家（美国、德国、法国、意大利、加拿大等），企业买家常常选择DAP，方便灵活。
  3. **进口税费较高，买家希望自行控制申报和缴税的国家**：如巴西、阿根廷、墨西哥等拉美国家，买家常常倾向于DAP方式。
  4. **卖家无法提供DDP服务的国家**：如部分非洲、中东、东南亚国家，卖家通常只支持DAP。
- **简要总结**：DAP适合政策要求收件人自理清关、买家具备清关能力、进口税费高或卖家无法提供DDP服务的国家和地区。常见于印度、东南亚、俄罗斯、拉美、部分欧美和非洲国家。实际选择时应结合目的国政策、买家能力和物流服务商支持情况。

#### 费用生成关系总结
- **自报关、DAP/DDU**：快递费用仅含运输，关税、增值税、代理费（如有）由收件人到付。
- **代理报关**：快递费用+代理费，关税、增值税由收件人到付或由代理代缴。
- **DDP**：快递费用已包含所有税费和代理费，收件人无需再支付。

> 前端应根据报关方式动态展示费用明细和提示，确保用户清楚各项费用的承担方和支付方式。

## DDP与代理报关的区别

DDP（完税后交货）和代理报关（agent declare）虽然都涉及由卖家或代理机构协助办理清关手续，但两者在费用承担、责任划分和用户体验上有明显区别：

### 1. DDP（完税后交货）
- **定义**：卖家负责将货物运输到买家指定地点，并承担所有运输、清关、缴税、代理等费用和风险，买家只需收货，无需再支付任何额外费用。
- **费用承担**：所有费用（运输费、关税、增值税、代理费等）全部由卖家承担，通常已包含在卖家报价或快递费用中。
- **责任划分**：卖家全权负责出口、进口清关、缴税、派送到门，买家无需参与清关流程。
- **用户体验**：买家体验最佳，收货最省心，无需操心清关和税费。
- **适用场景**：提升客户体验、减少售后沟通、适合对服务要求高的客户和国家。

### 2. 代理报关（agent declare）
- **定义**：买家委托快递公司或第三方报关行作为代理，代为办理进口清关手续。代理机构协助申报、缴税、清关，但费用通常由买家承担。
- **费用承担**：运输费和代理费可由卖家或买家支付，但关税、增值税等税费通常由买家到付（有时也可由卖家代付，具体看业务约定）。
- **责任划分**：代理机构负责协助清关，买家需配合提供资料并承担税费，卖家只负责发货和委托代理。
- **用户体验**：买家需配合清关，需支付税费和代理费，体验略逊于DDP。
- **适用场景**：买家不具备清关能力，需第三方协助，但不要求卖家全包所有费用。

### 3. 主要区别总结

| 对比项         | DDP（完税后交货）                | 代理报关（agent declare）           |
|----------------|----------------------------------|-------------------------------------|
| 费用承担方     | 卖家全包                         | 买家通常需到付税费和代理费          |
| 买家是否需清关 | 否，卖家/代理全权负责            | 是，需配合代理清关并支付税费        |
| 用户体验       | 最佳，买家只需收货               | 一般，买家需配合清关和缴税          |
| 适用场景       | 高端客户、服务要求高、全包服务   | 买家无清关能力但不要求全包          |
| 费用收取方式   | 一次性收齐所有费用               | 运输费可预收，税费/代理费到付为主   |

**简要总结：**
- **DDP**：卖家全包，买家无忧，费用全部预收，体验最佳，适合高端或服务要求高的客户。
- **代理报关**：代理协助，买家需配合清关和缴税，费用部分到付，适合买家无清关能力但不要求全包的场景。

## 2. 字段设计

| 字段名              | 说明                                   | 必填条件                   |
|---------------------|----------------------------------------|----------------------------|
| companyName         | 公司名称（可选）                       | 可选                       |
| taxId               | 税号/VAT号/EORI                        | 某些国家必填               |
| personalId          | 个人证件号/护照号                      | 某些国家必填               |
| declarationMethod   | 报关方式（自报/代理/DDP/DAP）          | 必填                       |
| purpose             | 用途（个人/商业/样品/礼品）            | 必填                       |
| declaredValue       | 申报价值（美元）                       | 必填                       |
| customsNote         | 报关备注（可选）                       | 可选                       |

- **动态必填字段**：如巴西、俄罗斯、韩国等国家，税号和/或个人证件号为强制项。
- **报关方式**：如选择"代理报关"或"DDP"，需提示："快递公司将协助报关，请确保信息准确完整。"

## 3. 费用计算逻辑

- **参数**：国家、报关方式、快递公司、申报价值、PCB类型（可选）
- **费用组成**：
  - 关税：申报价值 × 关税率（按国家）
  - 增值税：申报价值 × 增值税率（按国家）
  - 代理费：固定或按快递公司，仅代理/DDP时收取
  - 总计：上述费用之和，是否包含在快递费中取决于报关方式
- **示例公式**（见 `lib/customs-fee.ts`）：

```ts
export function calculateCustomsFee({
  country,
  declarationMethod,
  courier,
  declaredValue,
  pcbType,
}: CustomsFeeParams): CustomsFeeResult {
  let dutyRate = 0.1; // 默认10%
  let vatRate = 0.2;  // 默认20%
  let agentFee = 20;  // 默认代理费
  let includedInCourier = false;

  if (country === 'US') { dutyRate = 0.05; vatRate = 0; }
  if (country === 'DE') { dutyRate = 0.08; vatRate = 0.19; }
  // ...可扩展

  if (declarationMethod === 'ddp' || declarationMethod === 'agent') {
    includedInCourier = true;
  }

  const duty = declaredValue * dutyRate;
  const vat = declaredValue * vatRate;
  const total = duty + vat + (includedInCourier ? agentFee : 0);

  return {
    duty,
    vat,
    agentFee: includedInCourier ? agentFee : 0,
    total,
    includedInCourier,
    explain: includedInCourier
      ? '所有关税费用已包含在快递费中。'
      : '关税和税费将由海关或快递公司在交付时收取。',
  };
}
```

## 4. 前端集成

- 当国家、报关方式、快递公司或申报价值变更时，调用 `calculateCustomsFee` 并展示结果。
- 展示费用明细：关税、增值税、代理费、总计及说明。
- 选择DDP/代理报关时，显示蓝色提示："快递公司将协助报关，请确保信息准确完整。"
- 选择DAP/自报关时，显示提示："关税和税费将由海关或快递公司在交付时收取。"

## 5. 后续扩展

- 计算函数可替换为后端或第三方报关服务API。
- 费率、代理费等可维护在数据库或配置文件，便于更新。
- 可按需支持更多国家、快递公司、产品类型。

## 6. 小型PCB工厂最佳实践

- 表单尽量简洁，仅收集必要信息。
- 根据国家和报关方式动态调整必填项。
- 向用户提供清晰的提示和说明。
- 费用计算逻辑模块化，便于扩展。
- 始终告知用户：实际关税费用可能因当地法规和快递政策而有所不同。

## 7. 典型报关与费用场景举例

### 场景一：美国客户，选择DDP（完税后交货）

- **国家**：美国（US）
- **报关方式**：DDP
- **快递公司**：DHL
- **申报价值**：$200
- **费用计算**：
  - 关税率：5%
  - 增值税率：0%
  - 代理费：$20（包含在快递费中）
  - 关税：$200 × 0.05 = $10
  - 增值税：$200 × 0 = $0
  - 总计：$10 + $0 + $20 = $30
- **前端提示**：所有关税费用已包含在快递费中，无需收件人额外支付。

---

### 场景二：德国客户，选择DAP（到付，收件人自理税费）

- **国家**：德国（DE）
- **报关方式**：DAP
- **快递公司**：UPS
- **申报价值**：$500
- **费用计算**：
  - 关税率：8%
  - 增值税率：19%
  - 代理费：$0（不包含在快递费中）
  - 关税：$500 × 0.08 = $40
  - 增值税：$500 × 0.19 = $95
  - 总计：$40 + $95 = $135
- **前端提示**：关税和税费将由海关或快递公司在交付时收取，收件人需自理。

---

### 场景三：巴西客户，必须填写税号和个人证件号，选择代理报关

- **国家**：巴西（BR）
- **报关方式**：代理报关
- **快递公司**：FedEx
- **申报价值**：$300
- **必填字段**：taxId、personalId
- **费用计算**（假设）：
  - 关税率：12%
  - 增值税率：17%
  - 代理费：$25（包含在快递费中）
  - 关税：$300 × 0.12 = $36
  - 增值税：$300 × 0.17 = $51
  - 总计：$36 + $51 + $25 = $112
- **前端提示**：快递公司将协助报关，请确保税号和个人证件号填写准确。

---

### 场景四：韩国客户，选择自报关

- **国家**：韩国（KR）
- **报关方式**：自报关
- **快递公司**：EMS
- **申报价值**：$100
- **必填字段**：personalId
- **费用计算**（假设）：
  - 关税率：10%
  - 增值税率：10%
  - 代理费：$0
  - 关税：$100 × 0.10 = $10
  - 增值税：$100 × 0.10 = $10
  - 总计：$10 + $10 = $20
- **前端提示**：关税和税费将由海关或快递公司在交付时收取，收件人需自理。

---

### 场景五：英国客户，样品申报，低于免税额度

- **国家**：英国（UK）
- **报关方式**：DAP
- **快递公司**：DHL
- **申报价值**：$20（假设免税额度为£15）
- **费用计算**：
  - 关税率：0%
  - 增值税率：0%
  - 代理费：$0
  - 总计：$0
- **前端提示**：申报价值低于免税额度，通常无需缴纳关税和增值税，但请以当地海关实际为准。

---

### 场景六：俄罗斯客户，选择DDP，需填写税号

- **国家**：俄罗斯（RU）
- **报关方式**：DDP
- **快递公司**：CDEK
- **申报价值**：$150
- **必填字段**：taxId
- **费用计算**（假设）：
  - 关税率：15%
  - 增值税率：20%
  - 代理费：$30（包含在快递费中）
  - 关税：$150 × 0.15 = $22.5
  - 增值税：$150 × 0.20 = $30
  - 总计：$22.5 + $30 + $30 = $82.5
- **前端提示**：所有关税费用已包含在快递费中，需确保税号填写准确。

---

### 场景七：加拿大客户，选择DAP，申报价值高于免税额度

- **国家**：加拿大（CA）
- **报关方式**：DAP
- **快递公司**：UPS
- **申报价值**：$120
- **费用计算**（假设）：
  - 关税率：6%
  - 增值税率：5%
  - 代理费：$0
  - 关税：$120 × 0.06 = $7.2
  - 增值税：$120 × 0.05 = $6
  - 总计：$7.2 + $6 = $13.2
- **前端提示**：关税和税费将由海关或快递公司在交付时收取，收件人需自理。

---

## 8. 设计建议

- 针对不同国家、报关方式、快递公司，前端应动态调整必填字段、费用明细和提示内容。
- 对于特殊国家（如巴西、俄罗斯、韩国等），务必校验税号/个人证件号的填写。
- 申报价值低于免税额度时，前端可自动提示"通常无需缴税"，但仍需提醒以实际为准。
- 费用明细和提示建议以区块形式展示，便于用户理解和核对。
- 建议将各国关税、增值税、免税额度、代理费等参数配置化，便于后续维护和扩展。
- 复杂页面建议采用"页面-区块-基础组件"三级结构，提升复用性和可维护性。
- 费用计算逻辑建议前后端一致，便于校验和追溯。
- 始终告知用户：实际关税费用可能因当地法规和快递政策而有所不同。

## duty free（免税）说明

duty free（免税）指的是在特定条件下，商品在进出口或流通过程中可以免征关税（duty），即不需要向海关缴纳关税。

**定义**：
duty free 是指商品在进出口时，因满足某些政策、额度或用途要求，可以不缴纳关税。常见于国际机场、免税店、或申报价值低于当地免税额度的跨境电商包裹。

**常见场景**：
1. **免税额度内**：如英国个人包裹申报价值低于£15，通常可免征关税和增值税。
2. **免税商品**：某些特定商品（如样品、礼品、展品等）在符合条件时可免税。
3. **免税店购物**：在国际机场、港口等免税店购买的商品，离境时可免征进口国关税。

**注意事项**：
- duty free 仅指免征关税，不一定免征增值税（VAT）或其他税费。
- 是否免税以目的国海关政策为准，实际操作中需以当地法规为准。

**简要总结**：
duty free 就是"免关税"，即在特定条件下，商品可以不缴纳关税，但可能仍需缴纳其他税费（如增值税）。 